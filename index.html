<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CEP SavingsTrack ‚Äì Theo D√µi Ti·∫øt Ki·ªám CEP</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"></script>
  <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <link rel="stylesheet" href="style.css" />
</head>
<body class="bg-gray-50 font-sans">

<!-- SIDEBAR -->
<div id="sidebar" class="sidebar fixed left-0 top-0 h-full w-64 bg-navy text-white flex flex-col z-40 transition-transform">
  <div class="flex items-center gap-3 px-6 py-5 border-b border-blue-800">
    <div class="w-10 h-10 bg-gold rounded-full flex items-center justify-center">
      <i class="fa-solid fa-piggy-bank text-navy text-lg"></i>
    </div>
    <div>
      <div class="font-bold text-lg leading-tight">CEP SavingsTrack</div>
      <div class="text-blue-300 text-xs">Theo D√µi Ti·∫øt Ki·ªám CEP</div>
    </div>
  </div>
  <nav class="flex-1 py-4 overflow-y-auto">
    <a href="#" class="nav-link active" data-page="dashboard">
      <i class="fa-solid fa-gauge-high w-5"></i> T·ªïng Quan
    </a>
    <a href="#" class="nav-link" data-page="savings">
      <i class="fa-solid fa-book-open w-5"></i> S·ªï Ti·∫øt Ki·ªám
    </a>
    <a href="#" class="nav-link" data-page="calculator">
      <i class="fa-solid fa-calculator w-5"></i> M√°y T√≠nh L√£i Su·∫•t
    </a>
    <a href="#" class="nav-link" data-page="advisor">
      <i class="fa-solid fa-lightbulb w-5"></i> T∆∞ V·∫•n S·∫£n Ph·∫©m
    </a>
    <a href="#" class="nav-link" data-page="rates">
      <i class="fa-solid fa-percent w-5"></i> L√£i Su·∫•t Ng√¢n H√†ng
    </a>
    <a href="#" class="nav-link" data-page="settings">
      <i class="fa-solid fa-gear w-5"></i> C√†i ƒê·∫∑t
    </a>
  </nav>
  <div class="px-6 py-4 border-t border-blue-800 text-xs text-blue-400">
    D·ªØ li·ªáu l∆∞u c·ª•c b·ªô ¬∑ Ri√™ng t∆∞ 100%
  </div>
</div>

<!-- SIDEBAR OVERLAY -->
<div id="sidebar-overlay" class="hidden fixed inset-0 bg-black bg-opacity-40 z-30 md:hidden" onclick="toggleSidebar()"></div>

<!-- MAIN CONTENT -->
<div id="main-content" class="md:ml-64 min-h-screen">
  <!-- TOPBAR -->
  <header class="bg-white shadow-sm px-3 sm:px-6 py-3 sm:py-4 flex items-center justify-between sticky top-0 z-30">
    <div class="flex items-center gap-2 sm:gap-3 min-w-0">
      <button id="hamburger-btn" class="md:hidden shrink-0 p-2 text-gray-500 hover:text-navy" onclick="toggleSidebar()">
        <i class="fa-solid fa-bars text-xl"></i>
      </button>
      <div class="min-w-0">
        <h1 id="page-title" class="text-base sm:text-xl font-bold text-navy truncate">T·ªïng Quan</h1>
        <p id="page-subtitle" class="text-xs sm:text-sm text-gray-500">Ng√†y h√¥m nay: <span id="today-date"></span></p>
      </div>
    </div>
    <div class="flex items-center gap-2 shrink-0">
      <button id="notif-btn" class="relative p-2 text-gray-500 hover:text-navy" onclick="showNotifications()">
        <i class="fa-solid fa-bell text-xl"></i>
        <span id="notif-badge" class="hidden absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center"></span>
      </button>
      <button class="btn-gold px-3 sm:px-4 py-2 text-sm font-semibold rounded-lg" onclick="openAddSavings()">
        <i class="fa-solid fa-plus"></i><span class="hidden sm:inline ml-1">Th√™m S·ªï TK</span>
      </button>
    </div>
  </header>

  <!-- PAGES -->
  <main class="p-3 sm:p-6">
    <!-- PAGE: DASHBOARD -->
    <div id="page-dashboard" class="page active">
      <!-- Alert Banner -->
      <div id="alert-banner" class="hidden mb-4 p-4 bg-red-50 border border-red-200 rounded-xl flex items-start gap-3">
        <i class="fa-solid fa-triangle-exclamation text-red-500 mt-0.5 text-lg"></i>
        <div id="alert-content" class="text-sm text-red-700"></div>
      </div>

      <!-- Stats Cards -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
        <div class="stat-card bg-white rounded-xl p-5 shadow-sm border border-gray-100">
          <div class="flex items-center justify-between mb-3">
            <span class="text-sm text-gray-500">T·ªïng V·ªën G·ª≠i</span>
            <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
              <i class="fa-solid fa-vault text-navy"></i>
            </div>
          </div>
          <div id="stat-total-principal" class="text-2xl font-bold text-navy">0 ‚Ç´</div>
          <div class="text-xs text-gray-400 mt-1" id="stat-total-books">0 s·ªï ti·∫øt ki·ªám</div>
        </div>
        <div class="stat-card bg-white rounded-xl p-5 shadow-sm border border-gray-100">
          <div class="flex items-center justify-between mb-3">
            <span class="text-sm text-gray-500">L√£i T√≠ch L≈©y (∆Ø·ªõc T√≠nh)</span>
            <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center">
              <i class="fa-solid fa-arrow-trend-up text-green-600"></i>
            </div>
          </div>
          <div id="stat-total-interest" class="text-2xl font-bold text-green-600">0 ‚Ç´</div>
          <div class="text-xs text-gray-400 mt-1">T√≠nh ƒë·∫øn h√¥m nay</div>
        </div>
        <div class="stat-card bg-white rounded-xl p-5 shadow-sm border border-gray-100">
          <div class="flex items-center justify-between mb-3">
            <span class="text-sm text-gray-500">S·∫Øp ƒê·∫øn H·∫°n</span>
            <div class="w-10 h-10 bg-yellow-100 rounded-lg flex items-center justify-center">
              <i class="fa-solid fa-clock text-yellow-600"></i>
            </div>
          </div>
          <div id="stat-due-soon" class="text-2xl font-bold text-yellow-600">0</div>
          <div class="text-xs text-gray-400 mt-1">Trong 30 ng√†y t·ªõi</div>
        </div>
        <div class="stat-card bg-white rounded-xl p-5 shadow-sm border border-gray-100">
          <div class="flex items-center justify-between mb-3">
            <span class="text-sm text-gray-500">T·ªïng Nh·∫≠n Khi ƒêH</span>
            <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center">
              <i class="fa-solid fa-sack-dollar text-purple-600"></i>
            </div>
          </div>
          <div id="stat-total-payout" class="text-2xl font-bold text-purple-600">0 ‚Ç´</div>
          <div class="text-xs text-gray-400 mt-1">V·ªën + L√£i ƒë√°o h·∫°n</div>
        </div>
      </div>

      <!-- Timeline + Chart -->
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 mb-6">
        <div class="lg:col-span-2 bg-white rounded-xl p-5 shadow-sm border border-gray-100">
          <h2 class="font-semibold text-navy mb-4">L·ªãch ƒê√°o H·∫°n</h2>
          <div id="maturity-timeline" class="space-y-2">
            <div class="text-gray-400 text-sm text-center py-8">Ch∆∞a c√≥ s·ªï ti·∫øt ki·ªám n√†o</div>
          </div>
        </div>
        <div class="bg-white rounded-xl p-5 shadow-sm border border-gray-100">
          <h2 class="font-semibold text-navy mb-4">Ph√¢n B·ªï V·ªën</h2>
          <div style="position:relative; height:220px;">
            <canvas id="portfolio-chart"></canvas>
          </div>
          <div id="portfolio-legend" class="mt-3 space-y-1"></div>
        </div>
      </div>

      <!-- Recent + Alerts -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
        <div class="bg-white rounded-xl p-5 shadow-sm border border-gray-100">
          <h2 class="font-semibold text-navy mb-4">C·∫£nh B√°o & Nh·∫Øc Nh·ªü</h2>
          <div id="alerts-list" class="space-y-2">
            <div class="text-gray-400 text-sm text-center py-6">Kh√¥ng c√≥ c·∫£nh b√°o n√†o</div>
          </div>
        </div>
        <div class="bg-white rounded-xl p-5 shadow-sm border border-gray-100">
          <h2 class="font-semibold text-navy mb-4">S·ªï Ti·∫øt Ki·ªám G·∫ßn ƒê√¢y</h2>
          <div id="recent-savings" class="space-y-2">
            <div class="text-gray-400 text-sm text-center py-6">Ch∆∞a c√≥ s·ªï ti·∫øt ki·ªám n√†o</div>
          </div>
        </div>
      </div>
    </div>

    <!-- PAGE: SAVINGS BOOKS -->
    <div id="page-savings" class="page hidden">
      <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-2 mb-4">
        <div class="flex flex-wrap gap-2">
          <input id="search-savings" type="text" placeholder="T√¨m ki·∫øm..." class="input-field flex-1 min-w-[130px]" oninput="renderSavingsList()"/>
          <select id="filter-status" class="input-field flex-1 min-w-[130px]" onchange="renderSavingsList()">
            <option value="">T·∫•t c·∫£ tr·∫°ng th√°i</option>
            <option value="active">ƒêang g·ª≠i</option>
            <option value="due-soon">S·∫Øp ƒë·∫øn h·∫°n</option>
            <option value="overdue">Qu√° h·∫°n</option>
            <option value="matured">ƒê√£ ƒë√°o h·∫°n</option>
          </select>
          <select id="filter-bank" class="input-field flex-1 min-w-[130px]" onchange="renderSavingsList()">
            <option value="">T·∫•t c·∫£ ng√¢n h√†ng</option>
          </select>
        </div>
        <button class="shrink-0 btn-gold px-4 py-2 text-sm font-semibold rounded-lg" onclick="openAddSavings()">
          <i class="fa-solid fa-plus mr-1"></i> Th√™m S·ªï TK
        </button>
      </div>
      <div id="savings-list" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4"></div>
    </div>

    <!-- PAGE: CALCULATOR -->
    <div id="page-calculator" class="page hidden">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <!-- Input panel -->
        <div class="space-y-4">
          <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-100">
            <h2 class="font-semibold text-navy mb-4 flex items-center gap-2">
              <i class="fa-solid fa-calculator text-gold"></i> Th√¥ng S·ªë T√≠nh To√°n
            </h2>
            <div class="space-y-4">
              <div>
                <label class="label">S·ªë ti·ªÅn g·ªëc (‚Ç´)</label>
                <input id="calc-principal" type="text" inputmode="numeric" class="input-field w-full" placeholder="50.000.000" value="50.000.000" oninput="formatMoneyInput(this); runCalculatorDebounced()"/>
              </div>
              <div class="grid grid-cols-2 gap-3">
                <div>
                  <label class="label">L√£i su·∫•t (%/nƒÉm)</label>
                  <input id="calc-rate" type="number" class="input-field w-full" placeholder="5.80" value="5.80" step="0.1" oninput="runCalculatorDebounced()"/>
                  <p class="text-xs text-gray-500 mt-1">Nh·∫≠p l√£i su·∫•t ho·∫∑c ch·ªçn t·ª´ ng√¢n h√†ng ƒë·ªÉ t·ª± ƒë·ªông ƒëi·ªÅn</p>
                </div>
                <div>
                  <label class="label">K·ª≥ h·∫°n</label>
                  <select id="calc-term" class="input-field w-full" onchange="runCalculator()">
                    <option value="1">1 th√°ng</option>
                    <option value="2">2 th√°ng</option>
                    <option value="3">3 th√°ng</option>
                    <option value="6">6 th√°ng</option>
                    <option value="9">9 th√°ng</option>
                    <option value="12" selected>12 th√°ng</option>
                    <option value="18">18 th√°ng</option>
                    <option value="24">24 th√°ng</option>
                    <option value="36">36 th√°ng</option>
                  </select>
                </div>
              </div>
              <div class="grid grid-cols-2 gap-3">
                <div>
                  <label class="label">H√¨nh th·ª©c l√£i</label>
                  <select id="calc-interest-type" class="input-field w-full" onchange="runCalculator()">
                    <option value="maturity" selected>Cu·ªëi k·ª≥ (ƒê√°o h·∫°n)</option>
                    <option value="monthly">H√†ng th√°ng</option>
                    <option value="quarterly">ƒê·ªãnh k·ª≥ 3 th√°ng</option>
                    <option value="upfront">ƒê·∫ßu k·ª≥</option>
                  </select>
                </div>
                <div>
                  <label class="label">Ng√†y g·ª≠i</label>
                  <input id="calc-start-date" type="date" class="input-field w-full" oninput="runCalculatorDebounced()"/>
                </div>
              </div>
              <div class="border-t pt-4">
                <h3 class="font-medium text-sm text-gray-600 mb-3">M√¥ ph·ªèng R√∫t Tr∆∞·ªõc H·∫°n</h3>
                <div class="grid grid-cols-2 gap-3">
                  <div>
                    <label class="label">L√£i su·∫•t kh√¥ng k·ª≥ h·∫°n (%/nƒÉm)</label>
                    <input id="calc-demand-rate" type="number" class="input-field w-full" placeholder="0.1" value="0.5" step="0.01" oninput="runCalculatorDebounced()"/>
                  </div>
                  <div>
                    <label class="label">Ng√†y r√∫t d·ª± ki·∫øn</label>
                    <input id="calc-early-date" type="date" class="input-field w-full" oninput="runCalculatorDebounced()"/>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Rate comparison table -->
          <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-100">
            <h2 class="font-semibold text-navy mb-4 flex items-center gap-2">
              <i class="fa-solid fa-table text-gold"></i> So S√°nh K·ª≥ H·∫°n
            </h2>
            <div id="term-comparison-table" class="overflow-x-auto"></div>
          </div>
        </div>

        <!-- Result panel -->
        <div class="space-y-4">
          <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-100">
            <h2 class="font-semibold text-navy mb-4 flex items-center gap-2">
              <i class="fa-solid fa-chart-pie text-gold"></i> K·∫øt Qu·∫£ T√≠nh To√°n
            </h2>
            <div class="grid grid-cols-2 gap-3 mb-4">
              <div class="result-box bg-navy text-white rounded-xl p-4">
                <div class="text-xs text-blue-300 mb-1">Ti·ªÅn L√£i ƒê·∫øn H·∫°n</div>
                <div id="res-interest" class="text-xl font-bold">0 ‚Ç´</div>
              </div>
              <div class="result-box bg-green-50 rounded-xl p-4">
                <div class="text-xs text-green-600 mb-1">T·ªïng Nh·∫≠n V·ªÅ</div>
                <div id="res-total" class="text-xl font-bold text-green-700">0 ‚Ç´</div>
              </div>
              <div class="result-box bg-blue-50 rounded-xl p-4">
                <div class="text-xs text-blue-600 mb-1">Ng√†y ƒê√°o H·∫°n</div>
                <div id="res-maturity" class="text-base font-bold text-blue-700">‚Äî</div>
              </div>
              <div class="result-box bg-purple-50 rounded-xl p-4">
                <div class="text-xs text-purple-600 mb-1">Hi·ªáu Su·∫•t / NƒÉm</div>
                <div id="res-yield" class="text-xl font-bold text-purple-700">0%</div>
              </div>
            </div>

            <!-- Early withdrawal -->
            <div id="early-withdrawal-result" class="hidden border border-orange-200 bg-orange-50 rounded-xl p-4">
              <div class="font-semibold text-orange-700 mb-3 flex items-center gap-2">
                <i class="fa-solid fa-triangle-exclamation"></i> M√¥ Ph·ªèng R√∫t Tr∆∞·ªõc H·∫°n
              </div>
              <div class="grid grid-cols-2 gap-2 text-sm">
                <div>S·ªë ng√†y ƒë√£ g·ª≠i: <span id="res-days-elapsed" class="font-bold">0</span></div>
                <div>L√£i th·ª±c nh·∫≠n: <span id="res-early-interest" class="font-bold text-orange-700">0 ‚Ç´</span></div>
                <div>Thi·ªát h·∫°i so v·ªõi ƒêH: <span id="res-loss" class="font-bold text-red-600">0 ‚Ç´</span></div>
                <div>T·ª∑ l·ªá thi·ªát h·∫°i: <span id="res-loss-pct" class="font-bold text-red-600">0%</span></div>
              </div>
            </div>
          </div>

          <!-- Chart -->
          <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-100">
            <h2 class="font-semibold text-navy mb-4">Bi·ªÉu ƒê·ªì TƒÉng Tr∆∞·ªüng</h2>
            <div style="position:relative; height:220px;">
              <canvas id="calc-chart"></canvas>
            </div>
          </div>

          <!-- Add to tracker button -->
          <button onclick="addFromCalculator()" class="w-full btn-navy py-3 rounded-xl font-semibold text-white flex items-center justify-center gap-2">
            <i class="fa-solid fa-plus-circle"></i> Th√™m V√†o Danh S√°ch Theo D√µi
          </button>
        </div>
      </div>
    </div>

    <!-- PAGE: ADVISOR -->
    <div id="page-advisor" class="page hidden">
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <!-- Criteria input -->
        <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-100">
          <h2 class="font-semibold text-navy mb-4 flex items-center gap-2">
            <i class="fa-solid fa-sliders text-gold"></i> Ti√™u Ch√≠ C·ªßa B·∫°n
          </h2>
          <div class="space-y-4">
            <div>
              <label class="label">S·ªë ti·ªÅn mu·ªën g·ª≠i (‚Ç´)</label>
              <input id="adv-amount" type="text" inputmode="numeric" class="input-field w-full" placeholder="50.000.000" value="50.000.000" oninput="formatMoneyInput(this)"/>
            </div>
            <div>
              <label class="label">Th·ªùi gian g·ª≠i mong mu·ªën</label>
              <select id="adv-term" class="input-field w-full">
                <option value="any">Linh ho·∫°t (b·∫•t k·ª≥)</option>
                <option value="short">Ng·∫Øn h·∫°n (1‚Äì3 th√°ng)</option>
                <option value="medium">Trung h·∫°n (6‚Äì12 th√°ng)</option>
                <option value="long">D√†i h·∫°n (>12 th√°ng)</option>
              </select>
            </div>
            <div>
              <label class="label">∆Øu ti√™n</label>
              <select id="adv-priority" class="input-field w-full">
                <option value="rate">L√£i su·∫•t cao nh·∫•t</option>
                <option value="flexibility">T√≠nh linh ho·∫°t</option>
                <option value="bank">Ng√¢n h√†ng uy t√≠n</option>
              </select>
            </div>
            <div>
              <label class="label">M·ª•c ti√™u t√†i ch√≠nh</label>
              <select id="adv-goal" class="input-field w-full">
                <option value="savings">T√≠ch l≈©y th√™m</option>
                <option value="emergency">Qu·ªπ d·ª± ph√≤ng</option>
                <option value="investment">Sinh l·ªùi t·ªëi ƒëa</option>
                <option value="income">Thu nh·∫≠p l√£i h√†ng th√°ng</option>
              </select>
            </div>
            <div>
              <label class="label">M·ª©c ch·∫•p nh·∫≠n r·ªßi ro</label>
              <div class="flex gap-2">
                <button class="risk-btn active" data-risk="low" onclick="selectRisk(this,'low')">Th·∫•p</button>
                <button class="risk-btn" data-risk="medium" onclick="selectRisk(this,'medium')">Trung b√¨nh</button>
                <button class="risk-btn" data-risk="high" onclick="selectRisk(this,'high')">Cao</button>
              </div>
            </div>
            <button onclick="runAdvisor()" class="w-full btn-gold py-3 rounded-xl font-semibold flex items-center justify-center gap-2">
              <i class="fa-solid fa-wand-magic-sparkles"></i> Ph√¢n T√≠ch & T∆∞ V·∫•n
            </button>
          </div>
        </div>

        <!-- Results -->
        <div class="lg:col-span-2 space-y-4">
          <div id="advisor-summary" class="hidden bg-navy text-white rounded-xl p-5">
            <div class="flex items-start gap-3">
              <i class="fa-solid fa-robot text-gold text-2xl mt-1"></i>
              <div id="advisor-summary-text"></div>
            </div>
          </div>
          <div id="advisor-results" class="space-y-3">
            <div class="text-gray-400 text-sm text-center py-12 bg-white rounded-xl border border-gray-100">
              <i class="fa-solid fa-lightbulb text-4xl text-gray-200 mb-3 block"></i>
              ƒêi·ªÅn th√¥ng tin v√† nh·∫•n "Ph√¢n T√≠ch & T∆∞ V·∫•n" ƒë·ªÉ nh·∫≠n g·ª£i √Ω s·∫£n ph·∫©m ph√π h·ª£p
            </div>
          </div>
          <div id="advisor-chart-wrap" class="hidden bg-white rounded-xl p-5 shadow-sm border border-gray-100">
            <h3 class="font-semibold text-navy mb-3">So S√°nh L·ª£i Nhu·∫≠n C√°c S·∫£n Ph·∫©m ƒê·ªÅ Xu·∫•t</h3>
            <div style="position:relative; height:200px;">
              <canvas id="advisor-chart"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- PAGE: RATES -->
    <div id="page-rates" class="page hidden">
      <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-100 mb-4">
        <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-2 mb-4">
          <h2 class="font-semibold text-navy flex items-center gap-2">
            <i class="fa-solid fa-percent text-gold"></i> B·∫£ng L√£i Su·∫•t Ng√¢n H√†ng
          </h2>
          <div class="flex gap-2">
            <input id="rate-search" type="text" placeholder="T√¨m ng√¢n h√†ng..." class="input-field flex-1 min-w-[130px] sm:w-48" oninput="renderRatesTable()"/>
            <button id="auto-update-btn" onclick="autoUpdateRates()" class="shrink-0 bg-green-600 hover:bg-green-700 text-white px-3 sm:px-4 py-2 text-sm rounded-lg font-medium transition-colors">
              <i class="fa-solid fa-sync mr-1"></i><span class="hidden sm:inline">C·∫≠p Nh·∫≠t T·ª± ƒê·ªông</span><span class="sm:hidden">Auto</span>
            </button>
            <button onclick="openEditRates()" class="shrink-0 btn-navy px-3 sm:px-4 py-2 text-sm rounded-lg font-medium">
              <i class="fa-solid fa-pen mr-1"></i><span class="hidden sm:inline">S·ª≠a Th·ªß C√¥ng</span><span class="sm:hidden">S·ª≠a</span>
            </button>
          </div>
        </div>
        
        <!-- Legend Info -->
        <div class="mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg">
          <div class="flex flex-wrap items-center gap-3 text-sm text-gray-700">
            <span class="font-medium text-navy"><i class="fa-solid fa-info-circle mr-1"></i>Ch√∫ th√≠ch:</span>
            <span class="flex items-center gap-1">
              <span class="px-2 py-0.5 text-xs bg-green-100 text-green-700 rounded-full">üîÑ Auto</span>
              <span class="text-gray-600">= H·ªó tr·ª£ c·∫≠p nh·∫≠t t·ª± ƒë·ªông (9 ng√¢n h√†ng)</span>
            </span>
            <span class="flex items-center gap-1">
              <span class="px-2 py-0.5 text-xs bg-gray-100 text-gray-600 rounded-full">üìù Manual</span>
              <span class="text-gray-600">= Ch·ªâ nh·∫≠p th·ªß c√¥ng (6 ng√¢n h√†ng)</span>
            </span>
          </div>
        </div>
        
        <div class="overflow-x-auto">
          <div id="update-status" class="hidden mb-3 p-3 bg-blue-50 border border-blue-200 rounded-lg flex items-center gap-2">
            <i class="fa-solid fa-spinner fa-spin text-blue-600"></i>
            <span class="text-sm text-blue-700">ƒêang c·∫≠p nh·∫≠t l√£i su·∫•t t·ª´ c√°c ng√¢n h√†ng...</span>
          </div>
          <table class="w-full text-sm" id="rates-table">
            <thead>
              <tr class="bg-gray-50">
                <th class="text-left p-3 rounded-tl-lg font-semibold text-gray-600">Ng√¢n H√†ng</th>
                <th class="text-center p-3 font-semibold text-gray-600">KKH</th>
                <th class="text-center p-3 font-semibold text-gray-600">1T</th>
                <th class="text-center p-3 font-semibold text-gray-600">3T</th>
                <th class="text-center p-3 font-semibold text-gray-600">6T</th>
                <th class="text-center p-3 font-semibold text-gray-600">9T</th>
                <th class="text-center p-3 font-semibold text-gray-600">12T</th>
                <th class="text-center p-3 font-semibold text-gray-600">18T</th>
                <th class="text-center p-3 font-semibold text-gray-600">24T</th>
                <th class="text-center p-3 rounded-tr-lg font-semibold text-gray-600">36T</th>
              <!-- KKH column added dynamically -->
              </tr>
            </thead>
            <tbody id="rates-tbody"></tbody>
          </table>
        </div>
        <p class="text-xs text-gray-400 mt-3">
          * L√£i su·∫•t c√≥ th·ªÉ c·∫≠p nh·∫≠t t·ª± ƒë·ªông t·ª´ website ng√¢n h√†ng ho·∫∑c ch·ªânh s·ª≠a th·ªß c√¥ng. 
          <span class="text-blue-600">B·∫•m "C·∫≠p Nh·∫≠t T·ª± ƒê·ªông"</span> ƒë·ªÉ l·∫•y l√£i su·∫•t m·ªõi nh·∫•t t·ª´ c√°c ng√¢n h√†ng.
        </p>
      </div>

      <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-100">
        <h2 class="font-semibold text-navy mb-4">So S√°nh L√£i Su·∫•t Theo K·ª≥ H·∫°n</h2>
        <div style="position:relative; height:300px;">
          <canvas id="rates-chart"></canvas>
        </div>
      </div>
    </div>

    <!-- PAGE: SETTINGS -->
    <div id="page-settings" class="page hidden">
      <div class="max-w-2xl space-y-4">
        <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-100">
          <h2 class="font-semibold text-navy mb-4 flex items-center gap-2">
            <i class="fa-solid fa-bell text-gold"></i> C√†i ƒê·∫∑t C·∫£nh B√°o
          </h2>
          <div class="space-y-4">
            <div class="flex items-center justify-between">
              <div>
                <div class="font-medium">C·∫£nh b√°o s·∫Øp ƒë·∫øn h·∫°n</div>
                <div class="text-sm text-gray-500">Nh·∫Øc tr∆∞·ªõc bao nhi√™u ng√†y</div>
              </div>
              <select id="setting-warn-days" class="input-field w-32">
                <option value="7">7 ng√†y</option>
                <option value="14">14 ng√†y</option>
                <option value="30" selected>30 ng√†y</option>
                <option value="60">60 ng√†y</option>
              </select>
            </div>
            <div class="flex items-center justify-between">
              <div>
                <div class="font-medium">C·∫£nh b√°o c·∫≠p nh·∫≠t l√£i h√†ng th√°ng</div>
                <div class="text-sm text-gray-500">Nh·∫Øc tr∆∞·ªõc bao nhi√™u ng√†y</div>
              </div>
              <select id="setting-warn-interest-days" class="input-field w-32">
                <option value="1">1 ng√†y</option>
                <option value="3">3 ng√†y</option>
                <option value="7" selected>7 ng√†y</option>
                <option value="14">14 ng√†y</option>
              </select>
            </div>
            <div class="flex items-center justify-between">
              <div>
                <div class="font-medium">C·∫£nh b√°o m·ª©c thi·ªát h·∫°i r√∫t tr∆∞·ªõc h·∫°n</div>
                <div class="text-sm text-gray-500">Khi thi·ªát h·∫°i v∆∞·ª£t ng∆∞·ª°ng</div>
              </div>
              <select id="setting-loss-threshold" class="input-field w-32">
                <option value="5">5%</option>
                <option value="10" selected>10%</option>
                <option value="20">20%</option>
                <option value="50">50%</option>
              </select>
            </div>
          </div>
        </div>
        <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-100">
          <h2 class="font-semibold text-navy mb-4 flex items-center gap-2">
            <i class="fa-solid fa-database text-gold"></i> Qu·∫£n L√Ω D·ªØ Li·ªáu
          </h2>
          <div class="space-y-3">
            <div class="flex flex-wrap gap-3">
              <button onclick="exportData()" class="btn-navy px-4 py-2 text-sm rounded-lg font-medium">
                <i class="fa-solid fa-download mr-1"></i> Xu·∫•t D·ªØ Li·ªáu JSON
              </button>
              <button onclick="importData()" class="btn-outline px-4 py-2 text-sm rounded-lg font-medium">
                <i class="fa-solid fa-upload mr-1"></i> Nh·∫≠p D·ªØ Li·ªáu JSON
              </button>
              <button onclick="confirmClearData()" class="text-red-600 border border-red-200 px-4 py-2 text-sm rounded-lg font-medium hover:bg-red-50">
                <i class="fa-solid fa-trash mr-1"></i> X√≥a T·∫•t C·∫£ D·ªØ Li·ªáu
              </button>
            </div>
            <div class="border-t pt-3">
              <h3 class="font-medium text-sm text-gray-700 mb-2">Import Danh S√°ch S·ªï Ti·∫øt Ki·ªám</h3>
              <div class="flex flex-wrap gap-3">
                <button onclick="uploadSavingsList()" class="btn-gold px-4 py-2 text-sm rounded-lg font-medium">
                  <i class="fa-solid fa-file-excel mr-1"></i> Upload File Excel/CSV
                </button>
                <button onclick="downloadTemplate()" class="btn-outline px-4 py-2 text-sm rounded-lg font-medium">
                  <i class="fa-solid fa-file-download mr-1"></i> T·∫£i File M·∫´u
                </button>
              </div>
              <p class="text-xs text-gray-500 mt-2">H·ªó tr·ª£: Excel (.xlsx), CSV (.csv), JSON (.json)</p>
            </div>
          </div>
          <input type="file" id="import-file" accept=".json" class="hidden" onchange="handleImport(event)"/>
          <input type="file" id="upload-savings-file" accept=".xlsx,.xls,.csv,.json" class="hidden" onchange="handleUploadSavings(event)"/>
        </div>
        
        <!-- BACKUP & DATA PROTECTION -->
        <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-100">
          <h2 class="font-semibold text-navy mb-4 flex items-center gap-2">
            <i class="fa-solid fa-shield-halved text-gold"></i> Backup & B·∫£o V·ªá D·ªØ Li·ªáu
          </h2>
          <div id="backup-status-container" class="space-y-3">
            <!-- S·∫Ω ƒë∆∞·ª£c t·∫°o ƒë·ªông b·ªüi showBackupStatus() -->
          </div>
          <div class="space-y-3 mt-4">
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
              <h3 class="font-medium text-sm text-blue-900 mb-2">
                <i class="fa-solid fa-info-circle"></i> H·ªá Th·ªëng B·∫£o V·ªá D·ªØ Li·ªáu
              </h3>
              <ul class="text-xs text-blue-800 space-y-1 ml-4 list-disc">
                <li><strong>Auto-backup:</strong> T·ª± ƒë·ªông t·∫°o backup sau m·ªói 5 l·∫ßn thay ƒë·ªïi</li>
                <li><strong>L∆∞u gi·ªØ:</strong> T·ªëi ƒëa 5 phi√™n b·∫£n backup g·∫ßn nh·∫•t trong tr√¨nh duy·ªát</li>
                <li><strong>Kh√¥i ph·ª•c t·ª± ƒë·ªông:</strong> T·ª± ƒë·ªông kh√¥i ph·ª•c n·∫øu ph√°t hi·ªán d·ªØ li·ªáu b·ªã l·ªói</li>
                <li><strong>Nh·∫Øc nh·ªü:</strong> Nh·∫Øc xu·∫•t file backup sau m·ªói 7 ng√†y</li>
              </ul>
            </div>
            <div id="backup-list" class="space-y-2">
              <!-- Danh s√°ch backup s·∫Ω ƒë∆∞·ª£c t·∫°o ƒë·ªông -->
            </div>
            <button onclick="refreshBackupStatus()" class="btn-outline px-4 py-2 text-sm rounded-lg font-medium w-full">
              <i class="fa-solid fa-sync mr-1"></i> L√†m M·ªõi Tr·∫°ng Th√°i Backup
            </button>
          </div>
        </div>
        
        <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-100">
          <h2 class="font-semibold text-navy mb-4">Th√¥ng Tin ·ª®ng D·ª•ng</h2>
          <div class="text-sm text-gray-600 space-y-1">
            <div>Phi√™n b·∫£n: <strong>1.0.0 - CEP Edition</strong></div>
            <div>D·ªØ li·ªáu l∆∞u t·∫°i: <strong>localStorage c·ªßa tr√¨nh duy·ªát</strong></div>
            <div>M·∫∑c ƒë·ªãnh: <strong>CEP - T·ªï ch·ª©c T√†i ch√≠nh Vi m√¥</strong></div>
            <div>Ho√†n to√†n ri√™ng t∆∞ ‚Äì kh√¥ng g·ª≠i d·ªØ li·ªáu l√™n server</div>
          </div>
          <div class="mt-4 p-3 bg-green-50 border border-green-200 rounded-lg">
            <div class="text-xs text-green-800" id="cep-rate-info">
              <!-- filled by JS -->
            </div>
          </div>
          <div class="mt-2 p-3 bg-blue-50 border border-blue-200 rounded-lg">
            <div class="text-xs text-blue-800">
              <strong>üí° L∆∞u √Ω:</strong> L√£i su·∫•t c√≥ th·ªÉ thay ƒë·ªïi theo ch√≠nh s√°ch CEP.
              Vui l√≤ng ki·ªÉm tra t·∫°i CEP ƒë·ªÉ c√≥ th√¥ng tin m·ªõi nh·∫•t.
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>

<!-- MODAL: ADD/EDIT SAVINGS -->
<div id="modal-savings" class="modal-overlay hidden">
  <div class="modal-box bg-white rounded-2xl shadow-2xl w-full max-w-lg mx-4">
    <div class="flex items-center justify-between p-5 border-b">
      <h3 id="modal-savings-title" class="font-bold text-lg text-navy">Th√™m S·ªï Ti·∫øt Ki·ªám</h3>
      <button onclick="closeModal('modal-savings')" class="text-gray-400 hover:text-gray-600 text-xl"><i class="fa-solid fa-xmark"></i></button>
    </div>
    <div class="p-5 space-y-4 max-h-[75vh] overflow-y-auto">
      <input type="hidden" id="form-savings-id"/>
      <div class="grid grid-cols-2 gap-3">
        <div class="col-span-2">
          <label class="label">T√™n / Ghi Ch√∫ *</label>
          <input id="form-name" type="text" class="input-field w-full" placeholder="VD: S·ªï TK Vietcombank th√°ng 6"/>
        </div>
        <div class="col-span-2">
          <label class="label">Ng√¢n H√†ng *</label>
          <select id="form-bank" class="input-field w-full" onchange="updateRateFromBank()">
            <option value="">-- Ch·ªçn ng√¢n h√†ng --</option>
          </select>
        </div>
        <div>
          <label class="label">S·ªë Ti·ªÅn G·ªëc (‚Ç´) *</label>
          <input id="form-principal" type="text" inputmode="numeric" class="input-field w-full" placeholder="100.000.000" oninput="formatMoneyInput(this)"/>
        </div>
        <div>
          <label class="label">L√£i Su·∫•t (%/nƒÉm) *</label>
          <input id="form-rate" type="number" step="0.01" class="input-field w-full" placeholder="7.0"/>
          <p class="text-xs text-gray-500 mt-1">T·ª± ƒë·ªông ƒëi·ªÅn khi ch·ªçn ng√¢n h√†ng & k·ª≥ h·∫°n</p>
        </div>
        <div>
          <label class="label">Ng√†y G·ª≠i *</label>
          <input id="form-start-date" type="date" class="input-field w-full"/>
        </div>
        <div>
          <label class="label">K·ª≥ H·∫°n *</label>
          <select id="form-term" class="input-field w-full" onchange="updateRateFromBank()">
            <option value="1">1 th√°ng</option>
            <option value="2">2 th√°ng</option>
            <option value="3">3 th√°ng</option>
            <option value="6">6 th√°ng</option>
            <option value="9">9 th√°ng</option>
            <option value="12" selected>12 th√°ng</option>
            <option value="18">18 th√°ng</option>
            <option value="24">24 th√°ng</option>
            <option value="36">36 th√°ng</option>
          </select>
        </div>
        <div>
          <label class="label">H√¨nh Th·ª©c L√£i</label>
          <select id="form-interest-type" class="input-field w-full">
            <option value="maturity">Cu·ªëi k·ª≥ (ƒê√°o h·∫°n)</option>
            <option value="monthly">H√†ng th√°ng</option>
            <option value="quarterly">ƒê·ªãnh k·ª≥ 3 th√°ng</option>
            <option value="upfront">ƒê·∫ßu k·ª≥</option>
          </select>
        </div>
        <div>
          <label class="label">L√£i Su·∫•t Kh√¥ng KH (%/nƒÉm)</label>
          <input id="form-demand-rate" type="number" step="0.01" class="input-field w-full" placeholder="0.5" value="0.5"/>
        </div>
        <div class="col-span-2">
          <label class="label">S·ªë T√†i Kho·∫£n / S·ªë S·ªï (t√πy ch·ªçn)</label>
          <input id="form-account-no" type="text" class="input-field w-full" placeholder="1234567890"/>
        </div>
        <div class="col-span-2">
          <label class="label">Ghi Ch√∫ Th√™m</label>
          <textarea id="form-notes" class="input-field w-full h-20 resize-none" placeholder="Ghi ch√∫..."></textarea>
        </div>
        <div class="col-span-2">
          <label class="label">Tr·∫°ng Th√°i</label>
          <select id="form-status" class="input-field w-full">
            <option value="active">ƒêang g·ª≠i</option>
            <option value="matured">ƒê√£ ƒë√°o h·∫°n</option>
            <option value="withdrawn">ƒê√£ r√∫t</option>
          </select>
        </div>
      </div>
    </div>
    <div class="p-5 border-t flex gap-3">
      <button onclick="saveSavingsForm()" class="flex-1 btn-gold py-2.5 rounded-xl font-semibold">L∆∞u</button>
      <button onclick="closeModal('modal-savings')" class="flex-1 btn-outline py-2.5 rounded-xl font-semibold">H·ªßy</button>
    </div>
  </div>
</div>

<!-- MODAL: SAVINGS DETAIL -->
<div id="modal-detail" class="modal-overlay hidden">
  <div class="modal-box bg-white rounded-2xl shadow-2xl w-full max-w-2xl mx-4">
    <div class="flex items-center justify-between p-5 border-b">
      <h3 id="modal-detail-title" class="font-bold text-lg text-navy">Chi Ti·∫øt S·ªï Ti·∫øt Ki·ªám</h3>
      <button onclick="closeModal('modal-detail')" class="text-gray-400 hover:text-gray-600 text-xl"><i class="fa-solid fa-xmark"></i></button>
    </div>
    <div id="modal-detail-content" class="p-5 max-h-[75vh] overflow-y-auto"></div>
    <div class="p-5 border-t flex gap-3">
      <button id="detail-edit-btn" class="flex-1 btn-navy py-2.5 rounded-xl font-semibold">Ch·ªânh S·ª≠a</button>
      <button id="detail-delete-btn" class="flex-1 text-red-600 border border-red-200 py-2.5 rounded-xl font-semibold hover:bg-red-50">X√≥a</button>
      <button onclick="closeModal('modal-detail')" class="flex-1 btn-outline py-2.5 rounded-xl font-semibold">ƒê√≥ng</button>
    </div>
  </div>
</div>

<!-- MODAL: NOTIFICATIONS -->
<div id="modal-notif" class="modal-overlay hidden">
  <div class="modal-box bg-white rounded-2xl shadow-2xl w-full max-w-md mx-4">
    <div class="flex items-center justify-between p-5 border-b">
      <h3 class="font-bold text-lg text-navy">Th√¥ng B√°o & C·∫£nh B√°o</h3>
      <button onclick="closeModal('modal-notif')" class="text-gray-400 hover:text-gray-600 text-xl"><i class="fa-solid fa-xmark"></i></button>
    </div>
    <div id="notif-content" class="p-5 max-h-[70vh] overflow-y-auto space-y-3"></div>
  </div>
</div>

<!-- MODAL: EDIT RATES -->
<div id="modal-rates" class="modal-overlay hidden">
  <div class="modal-box bg-white rounded-2xl shadow-2xl w-full max-w-4xl mx-4">
    <div class="flex items-center justify-between p-5 border-b">
      <h3 class="font-bold text-lg text-navy">C·∫≠p Nh·∫≠t L√£i Su·∫•t Ng√¢n H√†ng</h3>
      <button onclick="closeModal('modal-rates')" class="text-gray-400 hover:text-gray-600 text-xl"><i class="fa-solid fa-xmark"></i></button>
    </div>
    <div class="p-5 max-h-[75vh] overflow-y-auto">
      <div class="text-sm text-gray-500 mb-4">C·∫≠p nh·∫≠t l√£i su·∫•t theo th√°ng. ƒê∆°n v·ªã: %/nƒÉm</div>
      <div id="edit-rates-form" class="overflow-x-auto"></div>
    </div>
    <div class="p-5 border-t flex gap-3">
      <button onclick="saveEditedRates()" class="flex-1 btn-gold py-2.5 rounded-xl font-semibold">L∆∞u L√£i Su·∫•t</button>
      <button onclick="closeModal('modal-rates')" class="flex-1 btn-outline py-2.5 rounded-xl font-semibold">H·ªßy</button>
    </div>
  </div>
</div>

<!-- MODAL: PREVIEW UPLOAD -->
<div id="modal-preview" class="modal-overlay hidden">
  <div class="modal-box bg-white rounded-2xl shadow-2xl w-full max-w-5xl mx-4">
    <div class="flex items-center justify-between p-5 border-b">
      <h3 class="font-bold text-lg text-navy">Xem Tr∆∞·ªõc D·ªØ Li·ªáu Import</h3>
      <button onclick="closeModal('modal-preview')" class="text-gray-400 hover:text-gray-600 text-xl"><i class="fa-solid fa-xmark"></i></button>
    </div>
    <div class="p-5 max-h-[70vh] overflow-y-auto">
      <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4 flex items-start gap-3">
        <i class="fa-solid fa-info-circle text-blue-600 mt-0.5"></i>
        <div class="text-sm text-blue-800">
          <strong id="preview-count"></strong> s·ªï ti·∫øt ki·ªám s·∫Ω ƒë∆∞·ª£c import. Ki·ªÉm tra d·ªØ li·ªáu tr∆∞·ªõc khi x√°c nh·∫≠n.
        </div>
      </div>
      <div class="mb-4 flex gap-3">
        <label class="flex items-center gap-2 cursor-pointer">
          <input type="radio" name="import-mode" value="add" checked class="w-4 h-4"/>
          <span class="text-sm font-medium">Th√™m v√†o danh s√°ch hi·ªán c√≥</span>
        </label>
        <label class="flex items-center gap-2 cursor-pointer">
          <input type="radio" name="import-mode" value="replace" class="w-4 h-4"/>
          <span class="text-sm font-medium">Thay th·∫ø to√†n b·ªô (x√≥a d·ªØ li·ªáu c≈©)</span>
        </label>
      </div>
      <div id="preview-content" class="overflow-x-auto"></div>
    </div>
    <div class="p-5 border-t flex gap-3">
      <button onclick="confirmImportSavings()" class="flex-1 btn-gold py-2.5 rounded-xl font-semibold">
        <i class="fa-solid fa-check mr-1"></i> X√°c Nh·∫≠n Import
      </button>
      <button onclick="closeModal('modal-preview')" class="flex-1 btn-outline py-2.5 rounded-xl font-semibold">H·ªßy</button>
    </div>
  </div>
</div>

<!-- TOAST -->
<div id="toast" class="toast hidden fixed bottom-6 right-6 z-50 px-5 py-3 rounded-xl shadow-lg text-white text-sm font-medium flex items-center gap-2">
  <i id="toast-icon" class="fa-solid fa-circle-check"></i>
  <span id="toast-msg"></span>
</div>

<script src="app.js"></script>
</body>
</html>
